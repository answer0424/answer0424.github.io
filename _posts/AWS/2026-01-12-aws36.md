---
layout: post
title: Amazon EC2 AMI 도구 설정
date: 2026-01-12 09:00:00 +09:00
categories: [AWS, EC2, AMI]
tags: [aws]
image:
    path: /assets/img/aws/AWS.png
---

## AMI 도구 설치 - RPM 방식

> AMI 도구를 RPM 패키지로 설치하려면 다음 절차를 따름

#### 1. Ruby 설치

```bash
sudo yum install -y ruby
```

<br>

#### 2. AMI 도구 다운로드

```bash
wget https://s3.amazonaws.com/ec2-downloads/ec2-ami-tools.noarch.rpm
```

<br>

#### 3. RPM 서명 검증

```bash
rpm -K ec2-ami-tools.noarch.rpm
```

<br>

#### 4. RPM 설치

```bash
sudo yum install ec2-ami-tools.noarch.rpm
```

<br>

#### 5. 설치 확인

```bash
ec2-ami-tools-version
```

> 이 명령은 설치된 도구의 버전 정보를 표시하여 설치 완료를 확인함

<br>

#### 추가 설정: RUBYLIB

```bash
export RUBYLIB=$RUBYLIB:/usr/lib/ruby/site_ruby:/usr/lib64/ruby/site_ruby
```

> 이후 다시 `ec2-ami-tools-version` 명령을 실행해 설치 완료를 확인

<hr>

## AMI 도구 설치 - ZIP 방식

> RPM이 지원되지 않는 Linux 배포판에서는 ZIP 아카이브를 사용함

#### 1. 필수 패키지 설치 (Ruby, unzip)

```bash
sudo apt-get update -y && sudo apt-get install -y ruby unzip
```

<br>

#### 2. ZIP 파일 다운로드


```bash
wget https://s3.amazonaws.com/ec2-downloads/ec2-ami-tools.zip
```

<br>

#### 3. 압축 해제

```bash
sudo mkdir -p /usr/local/ec2
sudo unzip ec2-ami-tools.zip -d /usr/local/ec2
```

<br>

#### 4. 환경 변수 설정

```bash
export EC2_AMITOOL_HOME=/usr/local/ec2/ec2-ami-tools-x.x.x
export PATH=$EC2_AMITOOL_HOME/bin:$PATH
```

<br>

#### 5. 설치 확인

```bash
ec2-ami-tools.version
```

<hr>

## 서명 인증서 (Signing Certificate) 관리

#### 1. OpenSSL 설치 및 설정

#### 2. RSA 프라이빗 키 생성

```bash
openssl genrsa 2048 > private-key.pem
```

#### 3. 인증서 생성

```bash
openssl req -new -x509 -nodes -sha256 -days 365 -key private-key.pem -outform PEM -out certificate.pem
```

<hr>

## 인증서 AWS 업로드

> 생성된 인증서를 IAM 사용자에 업로드

```bash
aws iam upload-signing-certificate \
    --user-name <user-name> \
    --certificate-body file://path/to/certificate.pem
```

> 이후 인증서 목록 조회, 활성화/비활성화, 삭제 등은 다음 명령을 사용

- 인증서 목록 조회

```bash
aws iam list-signing-certificates --user-name <user-name>
```

- 인증서 비활성화

```bash
aws iam update-signing-certificate \
    --user-name <user-name> \
    --certificate-id <certificate-id> \
    --status Inactive
```

- 인증서 삭제

```bash
aws iam delete-signing-certificate \
    --user-name <user-name> \
    --certificate-id <certificate-id>
```

<hr>

## 요약

| 절차 | 주요 내용 |
|-|-|
| RPM 설치 | Ruby 설치 ➡️ AMI 도구 RPM 다운로드 ➡️ 설치 ➡️ 설치 확인 |
| ZIP 설치 | Ruby + unzip 설치 ➡️ ZIP 다운로드 ➡️ 압축해제 ➡️ 환경 변수 설정 ➡️ 설치 확인 |
| 서명 인증서 | OpenSSL로 키/인증서 생성 ➡️ IAM Upload/관리 |
