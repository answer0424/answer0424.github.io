---
layout: post
title: AMI 계보를 사용하여 AMI의 기원 추적하기
date: 2026-01-21 09:00:00 +09:00
categories: [AWS, EC2, AMI]
tags: [aws]
image:
    path: /assets/img/aws/AWS.png
---

## 기본 개념 - 계보(Ancestry) 작동 방식

- 각 AMI는 소스 AMI의 AMI ID 및 리전을 정보로 보존함
- API/콘솔/CLI에서 AMI를 조회할 때, 계보 목록은 현재 AMI ➡️ 부모 AMI ➡️ 부모의 부모 ➡️ ...루트 AMI로 이어지는 전체 체인을 반환
- 루트 AMI의 조건
  - 퍼블릭 AMI
  - 상위 AMI 정보가 없는 경우
  - 상위 AMI가 다른 파티션에 속하는 경우
  - 목록이 50개까지 도달한 경우

<hr>

## 어떤 AMI에서 사용할 수 있는지?

1. `CreateImage`로 인스턴스에서 생성된 AMI
2. `copyImage`로 복사된 AMI
3. `CreateRestoreImageTask`로 복원된 AMI

<hr>

## 계보 정보 유지 조건

- AMI가 다른 리전으로 복사된 경우
- 소스 AMI가 등록 해제된 경우
- 계정이 소스 AMI에 대한 액세스 권한이 없는 경우

<hr>

## 확인 방법

#### AWS CLI/SDK/콘솔

- AWS 콘솔에서 해당 AMI를 선택하면 계보 정보가 표시될 수 있음
- CLI 또는 SDK에서는 AMI의 계보를 조회하는 APi `getImageAncestry`를 호출할 수 있음

<hr>

## 계보가 중요한 이유

- 컴플라이언스/규정 준수:
  - 조직의 이미지 정책 및 표준에 따라 AMI의 기원을 추적하여 규정 준수를 확인할 수 있음
- 보안 취약점 관리:
  - 상위 AMI에 보안 이슈가 발견되면, 해당 AMI로부터 파생된 모든 AMI를 쉽게 식별하고 영향 범위를 확인할 수 있음
- 리전 전체 가시성
  - AMI가 여러 리전으로 복사되어 다양한 워크로드에 사용되는 경우에도, 어디서 유래했는지 데이터가 남아 있어 추적이 쉬움