---
layout: post
title: VESUtil (3)
date: 2025-06-04  09:00 +09:00
categoties: [cbcp, week10]
tags: [cbcp]
---

#### getEncReqData()

> AES 대핑 키와 포기화 백터를 사용해 문자열을 암호화 후 Base64 인코딩된 문자열로 반환

- AES 키 준비 
- Cipher 객체 초기화(CBC 모드, PKCS5Pandding)
- 문자열 암호화 및 Base64 인코딩

<br>

#### createSymmetricKey()

> 매개변수로 받은 값들을 연결한 후, 그 값을 SHA-256 해시로 변환하고, Base64로 인코딩된 대칭 키 문자열을 생성

- 입력값 합치기
  - 공백 제거 후 하나의 값으로 만듦
- SHA-265 해시 처리
- Base64 인코딩

<br>

#### hmac256()

> 메시지에 서명(해싱)하기 위한 함수
>
> 데이터의 무결성과 인증을 위해 사용 
>
> 단순 해시보다 안전하며, 서명/토큰 생성, API 요청 검증 등에 자주 사용

- HMAC 알고리즘 객체 생성
- 비밀 키 설정
- 입력 메시지로 HMAC 계산
- 결과 반환

<br>

#### getResData()

> AES 암호화된 응답 데이터를 복호화하는 기능

- 대칭키 객체 생성
- Cipher 객체 초기화
- Base64 디코딩 후 복호화 수행
- 예외 처리 및 결과 반환

<br>

#### getSefCertEncToSci()

> SCI 본인인증 요청 암호화

- 요청을 위한 사용자 정보 `infoMap`
- 인증 요청 번호, 인증 요청 시간 추출
- 결과 코드가 성공일 경우(성공)
  - `symmetricKey`를 통해 `key`와 `iv`를 생성
  - `dataMap`에 id, 서비스 번호, 요청 번호, 인증 리턴 url등을 포함하여 저장
  - `symmetricKey`를 통해 `hmac256`으로 서명 암호화
- 결과 코드가 실패일 경우 
  - 암호화 토큰 발행 실패

<br>

#### getSefCertDrypFromSci()

> SCI 본인인증 응답 복호화

- 응답 결과 `infoMap`
- 요청 일자, 요청 번호, 암호화 토큰, 요청 정보 등을 추출
- 추출한 정보들을 토대로 `symmetricKey` 생성
- `symmetricKey`와 요청 정보를 토대로 `strResData` 생성
- 생성된 JSON 파일의 `strResData`를 `Map`으로 변환

