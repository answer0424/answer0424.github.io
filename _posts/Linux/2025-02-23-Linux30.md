---
layout: post
title: DNS Server
date: 2025-02-23 17:30 +09:00
categories: [Linux, advanced]
tags: [linux]
image:
    path: /assets/img/linux/Linux.png
---

## DNS (Domain Name System) ì„œë²„ ê°œìš”
> DNSëŠ” ë„ë©”ì¸ ì´ë¦„(www.example.com)ì„ IP ì£¼ì†Œ(192.168.1.1)ë¡œ ë³€í™˜í•˜ëŠ” ì‹œìŠ¤í…œì´ë‹¤
> ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•  ë•Œ ì‚¬ëŒì´ ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ë„ë©”ì¸ ëŒ€ì‹  ì„œë²„ì˜ IP ì£¼ì†Œë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ì£¼ëŠ” ì—­í• ì„ í•œë‹¤

<br>

## DNS ì„œë²„ì˜ ì—­í• 
1. ë„ë©”ì¸ -> IP ì£¼ì†Œ ë³€í™˜ (ì˜ˆ: `www.google.com` => `142.250.185.36`)
2. IP ì£¼ì†Œ -> ë„ë©”ì¸ ë³€í™˜ (ì—­ë°©í–¥ ì¡°íšŒ, PTR ë ˆì½”ë“œ)
3. ë©”ì¸ ì„œë²„ (MX ë ˆì½”ë“œ) ë° ê¸°íƒ€ ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ ì œê³µ
4. ìºì‹±ì„ í†µí•œ ë¹ ë¥¸ ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ

<br>

## DNS ì¡°íšŒ ê³¼ì •
1. ì‚¬ìš©ìê°€ `www.example.com`ì…ë ¥
2. í´ë¼ì´ì–¸íŠ¸(PC)ëŠ” ë¡œì»¬ DNS ìºì‹œ í™•ì¸
3. ì—†ìœ¼ë©´ ì§€ì •ëœ DNS ì„œë²„ (ì˜ˆ: ISP DNS)ë¡œ ìš”ì²­
4. ISP DNS ì„œë²„ëŠ” ìºì‹œì— ì—†ìœ¼ë©´ ë£¨íŠ¸ ë„¤ì„ì„œë²„(`.`)ì— ìš”ì²­
5. ë£¨íŠ¸ ë„¤ì„ì„œë²„ -> `.com` ë„¤ì„ì„œë²„ë¡œ ì „ë‹¬
6. `.com` ë„¤ì„ì„œë²„ -> `example.com` ë„¤ì„ì„œë²„ë¡œ ì „ë‹¬
7. ìµœì¢…ì ìœ¼ë¡œ `example.com`ì˜ DNS ì„œë²„ê°€ IP ì£¼ì†Œ ì œê³µ
8. í´ë¼ì´ì–¸íŠ¸ëŠ” í•´ë‹¹ IP ì£¼ì†Œë¡œ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†

<br>

## DNS ì„œë²„ ìœ í˜•

| DNS ì„œë²„ ìœ í˜• | ì„¤ëª… |
|---|---|
| ê¶Œí•œ(Authoritative) DNS | íŠ¹ì • ë„ë©”ì¸ì— ëŒ€í•œ ê³µì‹ DNS ì„œë²„ |
| ìºì‹œ(Cache) DNS | ìš”ì²­ëœ IP ì£¼ì†Œë¥¼ ì„ì‹œ ì €ì¥í•˜ì—¬ ë¹ ë¥¸ ì¡°íšŒ ì œê³µ |
| í¬ì›Œë”©(Forwarding) DNS | ìš”ì²­ì„ ìƒìœ„ DNS ì„œë²„ë¡œ ì „ë‹¬ |
| ì—­ë°©í–¥(Reverse) DNS | IP -> ë„ë©”ì¸ ë³€í™˜ (PTR ë ˆì½”ë“œ ì‚¬ìš©) |

<br>

## ë¦¬ëˆ…ìŠ¤ì—ì„œ DNS ì„œë²„ ì„¤ì • (BIND9)

#### BIND íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
sudo dnf install bind bind-utils -y
```

#### ì„¤ì • íŒŒì¼ ìˆ˜ì • (`/etc/named.conf`)

```bash
sudo vi /etc/named.conf
```

- ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •

```ini
options {
    listen-on port 53 { any; };
    allow-query { any; };
};

zone "example.com" IN {
    type master;
    file "/var/named/example.com.zone";
};
```

#### ë„ë©”ì¸ ì¡´ íŒŒì¼ ìƒì„± (`/var/named/example.com.zone`)

```bash
sudo vi /var/named/example.com.zone
```

```ini
$TTL 86400
@   IN  SOA ns1.example.com. admin.example.com. (
        2025022201 ; Serial
        3600       ; Refresh
        1800       ; Retry
        604800     ; Expire
        86400 )    ; Minimum TTL

    IN  NS  ns1.example.com.
ns1 IN  A   192.168.1.10
www IN  A   192.168.1.20
```

#### ì—­ë°©í–¥ DNS ì„¤ì • (`/var/named/1,168.192.in-addr.arpa`)

```bash
sudo vi /var/named/1.168.192.in-addr.arpa
```

```ini
$TTL 86400
@   IN  SOA ns1.example.com. admin.example.com. (
        2025022201 ; Serial
        3600       ; Refresh
        1800       ; Retry
        604800     ; Expire
        86400 )    ; Minimum TTL

    IN  NS  ns1.example.com.
10  IN  PTR ns1.example.com.
20  IN  PTR www.example.com.
```

#### ê¶Œí•œ ì„¤ì • ë° ì„œë¹„ìŠ¤ ì‹œì‘

```bash
sudo chown named:named /var/named/example.com.zone /var/named/1.168.192.in-addr.arpa
sudo systemctl restart named
sudo systemctl enable named
```

#### ë°©í™”ë²½ ì„¤ì •

```bash
sudo firewall-cmd --permanent --add-service=dns
sudo firewall-cmd --reload
```

<br>

## DNS ì„œë²„ í…ŒìŠ¤íŠ¸

#### ë„ë©”ì¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸

```bash
nslookup www.example.com 192.168.1.10
```

#### ì—­ë°©í–¥ ì¡°íšŒ í…ŒìŠ¤íŠ¸

```bash
nslookup 192.168.1.20 192.168.1.10
```

<br>

## ğŸ¯ ì •ë¦¬
- DNSëŠ” ë„ë©”ì¸ê³¼ IP ì£¼ì†Œë¥¼ ë³€í™˜í•˜ëŠ” ì—­í• 
- BIND9ë¥¼ ì‚¬ìš©í•´ ë¦¬ëˆ…ìŠ¤ì—ì„œ DNS ì„œë²„ êµ¬ì¶• ê°€ëŠ¥
- ì •ë°©í–¥ (`A` ë ˆì½”ë“œ) & ì—­ë°©í–¥ (`PTR` ë ˆì½”ë“œ) ì„¤ì • í•„ìš”
- ë°©í™”ë²½ ì„¤ì • í›„ `nslookup`ìœ¼ë¡œ í…ŒìŠ¤íŠ¸íŠ¸