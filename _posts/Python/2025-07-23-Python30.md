---
layout: post
title: 이터레이터 프로토콜 (__iter__, __next__)
date: 2025-07-23 13:00 +09:00
categories: [Python, functional programming]
tags: [python]
image:
    path: /assets/img/python/Python.png
---

## 이터레이터 프로토콜 요약

| 항목 | 설명 | 
|-|-|
| `__iter__()` | 이터레이터 객체 자체를 반환 |
| `__next__()` | 다음 값을 반환, 없으면 `StopIteration` 예외 발생 |
| 사용 목적 | `for` 루프 등에서 순회 가능한 객체 만들기 |

<br>

## 기본 개념

```python
class CountUpTo:
    def __init__(self, max):
        self.max = max
        self.current = 0

    def __iter__(self):
        return self
    
    def __next__(self):
        if self.current >= self.max:
            raise StopIteration
        self.current += 1
        return self.current
```

```python
counter = CountUpTo(3)
print(next(counter))  # 1
print(next(counter))  # 2
print(next(counter))  # 3
print(next(counter))  # StopIteration 예외 발생

```

<br>

## `for`문 내부 동작 방식

```python
for x in iterable:
    # 내부적으로 이렇게 동작
    iterator = iter(iterable)       # iterator.__iter__()
    while True:
        try:
            item = next(iterator)   # iterator.__next__()
            # do something with item
        except StopIteration:
            break
```