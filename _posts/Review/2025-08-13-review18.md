---
layout: post
title: 컴포넌트 간 State 공유하기
date: 2025-08-13 09:00 +09:00
categories: [React_re, state management]
tags: [react]
image:
    path: /assets/img/react/React.png
---

## State 끌어올리기 예시

> 예시에서 부모 컴포넌트인 `Accordian`이 두 개의 `Panel`을 렌더링

- `Accordian`
  - `Panel`
  - `Panel`
- 각 `Panel` 컴포넌트는 콘텐츠 표시 여부를 결정하는 boolean형 `isActive` 상태를 가짐

```jsx
import { useState } from 'react';

function Panel({ title, children }) {
  const [isActive, setIsActive] = useState(false);
  return (
    <section className="panel">
      <h3>{title}</h3>
      {isActive ? (
        <p>{children}</p>
      ) : (
        <button onClick={() => setIsActive(true)}>
          Show
        </button>
      )}
    </section>
  );
}

export default function Accordion() {
  return (
    <>
      <h2>Almaty, Kazakhstan</h2>
      <Panel title="About">
        With a population of about 2 million, Almaty is Kazakhstan's largest city. From 1929 to 1997, it was its capital city.
      </Panel>
      <Panel title="Etymology">
        The name comes from <span lang="kk-KZ">алма</span>, the Kazakh word for "apple" and is often translated as "full of apples". In fact, the region surrounding Almaty is thought to be the ancestral home of the apple, and the wild <i lang="la">Malus sieversii</i> is considered a likely candidate for the ancestor of the modern domestic apple.
      </Panel>
    </>
  );
}
```

> 한 패널의 버튼을 눌러도 다른 패널에는 영향을 미치지 않고 독립적

![alt text](/assets/img/react/react_re_18_01.png)

<br>

> 이제 한 번에 하나의 패널만 열리도록 변경
>
> 1. 자식 컴포넌트의 state를 제거
> 2. 하드 코딩된 값을 공통 부모로부터 전달
> 3. 공통 부모에 state를 추가하고 이벤트 핸들러와 함께 전달
>
> 이 방법으로 `Accordian` 컴포넌트가 두 `Panel`을 조정 후 한 번에 하나만 열리도록 할 수 있음

<br>

#### Step1: 자식 컴포넌트에서 state 제거

> `Panel`의 `isActive`에 대한 제어권을 부모 컴포넌트에 줄 수 있음
>
> 즉, 부모 컴포넌트는 `isActive`를 `Panel`에 prop으로 전달

- 다음 줄을 `Panel` 컴포넌트에서 제거

```jsx
const [isActive, setIsActive] = useState(false);
```

- 대신 `Panel`의 prop 목록에 `isActive`를 추가

```jsx
function Panel({title, children, isActive}) {}
```

- 이제 `Panel`의 부모 컴포넌트는 [props 내리꽂기](https://ko.react.dev/learn/passing-props-to-a-component)를 통해 `isActive`를 제어할 수 있음
- 반대로 `Panel` 컴포넌트는 `isActive`를 제어할 수 없음

<br>

#### Step2: 하드코딩된 데이터를 부모 컴포넌트로 전달

> state를 올리려면 조정하려는 두 자식 컴포넌트의 가장 가까운 공통 부모 컴포넌트에 두어야 함

- `Accordian` (가장 가까운 공통 부모)
  - `Panel`
  - `Panel`

```jsx
import { useState } from 'react';

export default function Accordion() {
  return (
    <>
      <h2>Almaty, Kazakhstan</h2>
      <Panel title="About" isActive={true}>
        With a population of about 2 million, Almaty is Kazakhstan's largest city. From 1929 to 1997, it was its capital city.
      </Panel>
      <Panel title="Etymology" isActive={true}>
        The name comes from <span lang="kk-KZ">алма</span>, the Kazakh word for "apple" and is often translated as "full of apples". In fact, the region surrounding Almaty is thought to be the ancestral home of the apple, and the wild <i lang="la">Malus sieversii</i> is considered a likely candidate for the ancestor of the modern domestic apple.
      </Panel>
    </>
  );
}

function Panel({ title, children, isActive }) {
  return (
    <section className="panel">
      <h3>{title}</h3>
      {isActive ? (
        <p>{children}</p>
      ) : (
        <button onClick={() => setIsActive(true)}>
          Show
        </button>
      )}
    </section>
  );
}
```

<br>

#### Step3: 공통 부모에 state 추가하기

> 상태 끌어올리기는 종종 state로 저장하고 있는 것의 특성을 바꿈
>
> 이를 위해 공통 부모 컴포넌트인 `Accordian`은 어떤 패널이 활성화된 채널인지 추적하고 있어야 함
>
> state 변수에 `boolean` 값을 사용하는 대신, 활성화되어 있는 `Panel`의 인덱스 숫자를 사용할 수 있음

```jsx
const [activeIndex, setActiveIndex] = useState(0);