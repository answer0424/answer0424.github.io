---
layout: post
title: Bean Scopes
date: 2025-09-16 09:00 +09:00
categories: [Spring, IoC Container(dependency)]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- Spring에서 Bean Definition은 객체 인스턴스를 만드는 설계도
- 빈 스코프(scope)는 이 설계도로부터 실제 빈 인스턴스들이 얼마나 오래, 어떤 범위에서 유지될지 정의
- Spring은 기본적으로 여러 스코프를 제공, 웹 어플리케이션 맥락(web-aware ApplicationContext)을 쓸 경우에만 유효한 스코프로 있고, 커스텀 스코프도 만들 수 있음

<br>

## 주요 빈 스코프들

| 스코프 이름     | 설명                                                                                      | 사용 예시                                          |
| --------------- | ----------------------------------------------------------------------------------------- | -------------------------------------------------- |
| **singleton**   | 기본값. IoC 컨테이너당 하나의 인스턴스만 생성. 모든 요청에서 동일한 인스턴스 반환         | 상태가 없는(stateless) 서비스 레이어 빈, DAO 빈 등 |
| **prototype**   | 빈 요청 시마다 새로운 인스턴스 생성. IoC 컨테이너가 관리하지 않음(생성 후 소멸 책임 없음) | 상태를 가지는(stateful) 객체, 임시 객체 등         |
| **request**     | 웹 어플리케이션에서 HTTP 요청당 하나의 인스턴스 생성. 요청이 끝나면 소멸                  | 웹 컨트롤러에서 요청별 상태 유지                   |
| **session**     | HTTP 세션당 하나의 인스턴스 생성. 세션이 끝나면 소멸                                      | 사용자 세션별 상태 유지                            |
| **application** | 서블릿 컨텍스트당 하나의 인스턴스 생성. 웹 애플리케이션 전체에서 공유                     | 애플리케이션 범위의 설정 정보 등                   |
| **websocket**   | 웹소켓 세션당 하나의 인스턴스 생성. 웹소켓 세션이 끝나면 소멸                             | 웹소켓 연결별 상태 유지                            |

<br>

## 스코프별 생명주기 및 객체 관리

- **싱글톤**: 애플리케이션 시작 시점에 생성, 애플리케이션 종료 시점에 소멸
- **프로토타입**: 요청 시점에 생성, 이후 컨테이너가 관리하지 않음. 개발자가 직접 소멸 처리 필요

<br>

## 스코프 간의 관계 & 주의사항

- 싱글톤 빈이 프로토타입 빈을 의존할 때 주의 필요: 싱글톤 빈이 생성될 때 프로토타입 빈이 한 번만 주입되므로, 매번 새로운 인스턴스를 원한다면 `@Lookup` 어노테이션이나 메서드 인젝션(method injection) 사용 고려
- 짧은 수명의 스코프를 더 긴 수명의 빈에 의존성으로 주입할 경우 프록시를 사용해야 제대로 동작

<br>

