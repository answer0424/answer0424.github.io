---
layout: post
title: Using @Value
date: 2025-09-16 13:00 +09:00
categories: [Spring, Core Technologies, IoC Container, Annotation_based container]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개념 개요

- `@Value`는 스프링 빈의 필드, 생성자 파라미터, 메서드 파라미터 등에 외부 설정 혹은 표현식 값을 주입할 때 사용되는 어노테이션
- 예를 들면 `application.properties` 파일이나 시스템 속성, 환경 변수, 혹은 SpEL을 통해 동적으로 값을 계산해서 주입 가능

<br>

## 동작 방식/특징

| 특징 | 설명 |
|-|-|
| 프로퍼티 플레이스 홀더 `${...}` | 대부분 빈 값(property) 읽을 때 `${property.name}` 형태로 사용 |
| 기본값 지정 | 프로퍼티가 정의되어 있지 않은 경우 대비해서 기본값을 지정할 수 있음 `${property.name:defaultValue}` 형태로 사용 |
| SpEL | `${...}` 구분을 사용해서 표현식을 계산한 값도 주입 가능 |
| 타입 변환 자동 처리 | 문자열로부터 필요한 타입으로 자동 변환, 스프링의 `conversionService`나 기본 컨버터가 내부적으로 작동 |


<br>

## 사용 예시

```java
@Component
public class MovieRecommender {

    // properties 파일(application.properties 등)에 catalog.name=MovieCatalog 가 정의됨
    @Value("${catalog.name}")
    private String catalogName;

    public void printCatalog() {
        System.out.println("Catalog name = " + catalogName);
    }
}
```

```ini
catalog.name=MovieCatalog
```


<br>

## 기본값 포함

```java
@Component
public class AppConfigConsumer {

    // 만약 catalog.name 프로퍼티가 없으면 "DefaultCatalog"가 기본값으로 사용됨
    @Value("${catalog.name:DefaultCatalog}")
    private String catalogName;
}
```

<br>

## SpEL 사용 예시

```java
@Component
public class SystemInfo {

    @Value("#{systemProperties['user.name'] + '/config'}")
    private String configPath;
}
```

<br>

## 배열 또는 컬렉션 주입

```properties
supported.locales=en,fr,de
```

```java
@Component
public class LocaleSupport {
    @Value("${supported.locales}")
    private String[] locales;

    // 혹은
    @Value("#{'${supported.locales}'.split(',')}")
    private List<String> localeList;
}
```

<br>

## 주의 사항

- 프로퍼티가 없는 경우 예외 여부를 제어하고 싶으면 `PropertySourcesPlaceholderConfigurer` 빈을 설정
- SpEL 표현식은 편하지만 복잡해지면 읽기/유지보수 어려울 수 있으므로 적절히 사용해야 함
- 다형성이나 복잡한 타입 변환이 필요한 경우에는 `@ConfigurationProperties`를 사용하는 것이 더 나을 수 있음
- `@Value` 어노테이션은 `BeanPostProcessor` 단계에서 처리되므로, 그 전에 값이 필요한 경우 timing 문제가 발생할 수 있어 주의
- 표현식 사용에는 `#{}`와 `${}`의 차이를 명확히 이해하고 사용해야 함