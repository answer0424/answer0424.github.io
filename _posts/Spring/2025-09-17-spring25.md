---
layout: post
title: 포인트컷 선언
date: 2025-09-17 13:00 +09:00
categories: [Spring, AOP, AspectJ]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## Pointcut의 개념 & 동작

- 포인트 컷은 언제 공통 관심자(advice)가 적용될지(join point)를 선택하는 조건(predicate) 또는 표현식

<br>

## 자주 쓰는 포인트컷 디자인 & 예시

| 디자인        | 의미                                               | 예시                                                                                                        |
| ------------- | -------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| `execution`   | 메서드 실행에 대해 매칭                            | `execution(* com.example.service.*.*(..))` - 패키지 내의 모든 메서드 실행                                   |
| `within`      | 특정 타입의 코드 범위 내에 있는 메서드             | `within(com.example.repository..*)` - 서비스 패키지 및 하위 패키지 전체                                     |
| `bean`        | 빈 이름에 따라 매칭                                | `bean(*Service)` - 이름이 Service로 끝나는 모든 빈                                                          |
| `@annotation` | 실행되는 메서드에 특정 어노테이션이 붙어 있는 경우 | `@annotation(org.springframework.transaction.annotation.Transactional)` - 트랜잭션 어노테이션이 붙은 메서드 |
| `@within`     | 선언된 타입에 특정 어노테이션이 붙은 경우          | `@within(org.springframework.stereotype.Service)` - 서비스 어노테이션이 붙은 클래스 내의 모든 메서드        |
| `@target`     | 런타임 대상 객체의 타입에 어노테이션이 붙은 경우   | `target(...)` - 실제 호출 대상 객체의 클래스가 어노테이션을 가지고 있을 때 매칭                             |
| `args`        | 메서드 인자로 주어진 값의 타입 조건                | `args(java.io.Serializable)` - Serializable 타입의 인자를 받는 메서드                                       |

<br>

## 사용 예시

```java
@Aspect
public class LoggingAspect {

    // Bean 이름이 *Service 로 끝나고, com.example.service 패키지 안의 클래스의 모든 메소드 실행 시 로깅
    @Pointcut("execution(* com.example.service..*.*(..)) && bean(*Service)")
    public void serviceMethods() {}

    @Before("serviceMethods()")
    public void beforeServiceMethods(JoinPoint jp) {
        System.out.println("Before: " + jp.getSignature());
    }

    // 특정 어노테이션 @Transactional 이 붙은 메소드에만 로깅
    @Pointcut("@annotation(org.springframework.transaction.annotation.Transactional)")
    public void transactionalMethods() {}

    @After("transactionalMethods()")
    public void afterTransaction(JoinPoint jp) {
        System.out.println("After transactional: " + jp.getSignature());
    }
}
```