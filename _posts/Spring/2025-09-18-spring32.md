---
layout: post
title: 자동 프록시
date: 2025-09-18 13:00:00 +09:00
categories: [Spring, AOP, Spring AOP API]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 기능 설명

> auto-proxy는 스프링 컨테이너에서 빈이 로드될 때 자동으로 AOP 프록시를 씌워주는 기능
> 
> 개발자가 수동으로 `ProxyFactoryBean`을 사용해서 프록시를 만들 필요 없이, 특정 빈을 자동으로 감싸서 advice가 적용되게 할 수 있음

- 자동 프록시 기능은 스프링의 `BeanPostProcessor` 인프라를 기반으로 동작
- 빈이 생성되는 과정에서 후처리(post-processing)를 통해, 이 빈이 프록시 대상인지 판단하고 대상이라면 proxy를 만들어서 그 빈을 대신 반환하게 함

<br>

## 종류 및 주요 구현체

| 구현체 이름 | 동작 방식 / 특징 |
|-|-|
| `BeanNameAutoProxyCreator` | 빈 이름이 특정 패턴에 매칭되는 경우에 프록시를 씌움, 예를 들어 `beanNames="jdk*, onlyJdk*"` 같은 이름 패턴 지정 가능 |
| `DefaultAdvisorAutoProxyCreator` | 더 일반적인 방식으로 컨텍스트 내의 Advisor들을 모두 살펴보고 각 Advisor의 Pointcut이 빈의 메서드들 중 어떤 것과 매칭되는지를 판단 |

> 자동 프록시 생성은 빈 이름 기반이든 advisor 기반이든, 빈의 등록 시점 또는 빈 초기화 전에 적용
>
> 빈이 proxy로 감싸지면, 사용자가 `getBean()` 하거나 DI 받을 때 실제 Proxy 객체가 주어짐

<br>

## 장단점 및 유의사항

- 장점
  - 프록시 설정 반복 제거 ➡️ 설정이 간단해지고 선언적으로 AOP 기능 적용 가능
  - 빈이 많고 공통적인 advice를 여러 빈에 동일하게 적용해야 할 때 특히 유용
  - 코드 변경 없이 advisor 추가/제거만으로 cross-cutting concern을 유연하게 활성화 또는 비활성화 가능
- 제한/주의
  - 어떤 빈들이 proxy 대상인지 명확히 파악 필요 ➡️ 너무 많은 빈을 proxy 하면 오버헤드가 생길 수 있음
  - bean 이름 기반일 경우 이름 변경 시 proxy 적용 여부가 달라질 수 있으므로 유지보수가 힘들 수 있음
  - 빈이 `Advisor` 기반인지, 혹은 `interceptorNames` 방식인지, 어떤 pointcut 조건이 있는지 등을 잘 설계해야 기대한 빈에만 정확히 advice가 적용됨

<br>