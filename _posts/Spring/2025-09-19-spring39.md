---
layout: post
title: 선언적 트랜잭션 구현의 예
date: 2025-09-19 09:00:00 +09:00
categories: [Spring, DataAccess, Transaction Management, Declarative Transaction Management]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- `FooService`라는 서비스 인터페이스와 그 구현체 `DefaultFooService`를 사용해서 메서드 별로 트랜잭션의 읽기 전용 또는 읽기쓰기 트랜잭션을 선언적으로 지정함
- context.xml 설정을 통해 트랜잭션 `tx:advice`를 정의하고 서비스 빈에 트랜잭션 프록시를 생성해서 트랜잭션이 적요되도록 함

<br>

## 예제 구성 요소

| 요소 | 역할/설명 |
|-|-|
| `FooService` 인터페이스 | 트랜잭션을 적용할 메서드들의 선언(`getFoo`, `insertFoo`, `updateFoo`) |
| `DefaultFooService` 구현체 | 실제 동작하지만 예제로는 `UnsupportedOperationException`을 던져서 트랜잭이 롤백되는 동작을 테스트 |
| XML 설정 (`context.xml`) | `<tx:advice>` 태그로 트랜잭션 속성 지정: 메서드 이름이 "get"으로 시작하는 메서드는 `read-only` 트랜잭션 사용, 그 외 메서드는 기본 트랜잭션 사용 |
| `transaction-manager` 빈 | 트랜잭션을 실제 시작/커밋/롤백하는 역할을 할 `TransactionManager` 빈이 지정됨. 설정에서 `<tx:advice>`에 `transaction-manager="txManager"`같은 속성으로 참조 |
| AOP 설정 | 서비스 빈에 대해 트랜잭션 advice를 적용하기 위해 AOP 프록시를 생성하도록 설정. 서비스의 메서드 호출이 프록시를 통해 감싸져서 트랜잭션 구문이 실행 |

<br>

## 동작 흐름

1. 