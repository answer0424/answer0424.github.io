---
layout: post
title: Using @Transactional
date: 2025-09-22 09:00:00 +09:00
categories: [Spring, DataAccess, Transaction Management, Declarative Transaction Management]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 핵심 내용 정리: `@Transactional` 어노테이션 사용법


#### 어노테이션 정의 및 적용 대상

- `@Transactional`은 클래스, 인터페이스, 메서드 위에 붙일 수 있고, 해당 메서드 호출 시 트랜잭션 처리를 적용하도록 하는 메타데이터
- 단순히 어노테이션만 붙인다고 동작이 활성화되는 것이 아니고, 실제 트랜잭션 관리가 가능한 설정이 필요(`@EnableTransactionManagement` 또는 XML 설정)

<br>

#### 기본 설정

- 기본 전파전략(propagation)은 `REQUIRED`, 격리수준(isolation)은 `DEFAULT`, 읽기/쓰기(read-write)모드, 타임아웃(timeout) 없음, 런타임 예외와 `Error`가 발생했을 때 롤백됨

<br>

#### 프록시 모드 vs AspectJ 모드

- 기본은 프록시 모드로, 외부에서 프록시를 통해 호출된 메서드에만 트랜잭션이 적용됨 `mode="aspectj"`설정하면 AspectJ 방식으로 weaving해서 이런 제한이 줄어듬

<br>

#### 메서드 접근성

- 원래 public 메서드에만 `@Transactional` 붙이는 경우가 많았지만, Spring 6.0부터는 protected, package-private 메서드에도 적용 가능
- 인터페이스 기반 프록시는 public 메서드만 가능

<br>

#### 반응형 트랜잭션 지원

- 반환 타입이 리액티브 타입인 경우 reactive 트랜잭션 관리자가 사용되고, 일반 타입이라면 imperative 트랜잭션 경로가 사용

<br>

#### 속성들

- `@Transactional`의 주요 속성들
  - `propagation`: 트랜잭션 전파 전략 (예: REQUIRED, REQUIRES_NEW 등)
  - `isolation`: 트랜잭션 격리 수준 (예: READ_COMMITTED, SERIALIZABLE 등)
  - `readOnly`: 읽기 전용 트랜잭션 여부
  - `timeout`: 트랜잭션 타임아웃 시간(초)
  - `rollbackFor` / `noRollbackFor`: 롤백/비롤백 대상 예외 지정

<br>

#### 제한/주의사항

- self-invoke되는 메서드 호출은 프록시를 통하지 않기 때문에 `@Transactional`이 붙어있어도 트랜잭션이 적용 안될 수도 있고 초기화 코드(`@PostConstruct` 등)나 빈 초기 생성 시점에는 프록시가 완성되지 않은 상태라 작동이 기대만큼 안될 수 있음
- 또한 인터페이스 선언부에 어노테이션만 있어도 동작하는 경우가 있지만, AspectJ 모드나 리플렉션 기반 취급 등에 따라 무시될 수 있음

<br>

## 정리

> `@Transactional`은 메서드 또는 클래스 수준에서 트랜잭션 경계를 선언적으로 지정할 수 있게 해주는 어노테이션으로, 기본적으로 프록시 기반으로 동작하며 propagation, isolation, rollback 규칙 등을 속성을 조정 가능