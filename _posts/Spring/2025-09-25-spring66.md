---
layout: post
title: Locale
date: 2025-09-25 13:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, DispatcherServlet]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---


## 개요 및 역할

- Spring MVC는 클라이언트의 요청마다 지역화를 위해 LocaleResolver를 사용해 요청의 locale을 자동으로 결정
- `DispatcherServlet`은 요청이 들어오면 먼저 `LocaleResolver` 빈이 있는지 확인하고, 있다면 그것을 사용해 locale을 자동으로 결정
- 추가로 `LocaleInterceptor` 같은 인터셉터를 핸들러 매핑에 연결해서 요청 파라미터 등으로 locale을 동적으로 변경할 수 있음

<br>

## LocaleResolver 구현체들 및 특징

#### `Header Resolver`

- HTTP 요청의 `Accept-Language` 헤더를 기반으로 locale을 결정
- 시간대 정보는 지원하지 않음

<br>

#### `CookieLocaleResolver`

- 클라이어느의 쿠키에 locale 정보를 저장하고 이를 읽어서 locale을 결정 
- 쿠키 이름, 수명, 경로 등을 설정 가능

<br>

#### `SessionLocaleResolver`

- 사용자의 `HttpSession`에 locale/timezone 정보를 저장하고 요청 때마다 세션을 참조해서 locale을 결정
- 세션이 종료되면 locale 정보도 사라짐

<br>

#### `LocaleContextResolver`

- `LocaleResolver`의 확장 개념으로 locale뿐 아니라 time zone 정보도 함께 제공 가능한 `LocaleContext`를 반환

<br>

## 동작 흐름(요청 ➡️ locale 결정 ➡️ 처리)

1. 클라이언트가 HTTP 요청을 보냄
2. `DispatcherServlet`이 요청을 처리하면서 localeResolver 빈 존재 여부 확인
3. localeResolver를 통해 locale 결정
4. `LocaleChangeInterceptor`가 요청 파라미터로 locale 변경을 감지하면 `setLocale(...)` 호출
5. 이후 요청 처리에서 결정된 locale이 사용됨
6. `RequestContext.getLocale()` 등으로 locale을 참조 가능

<br>

## 핵심

> Spring MVC는 `LocaleResolver` + `LocaleChangeInterceptor` 조합으로, 클라이언트의 요청 언어 설정을 자동 해석하거나 변경 가능하게 지원