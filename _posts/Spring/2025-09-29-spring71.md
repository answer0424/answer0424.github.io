---
layout: post
title: HTTP 메세지 변환
date: 2025-09-29 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 문서 개요 및 역할

- Spring의 `spring-web` 모듈은 `HttpMessageConverter` 인터페이스를 제공해서, HTTP 요청/응답 본문을 `InputStream` ↔️ 객체, `OutputStream` ↔️ 객체 간 변환할 수 있도록 함
- 이 변환기는 Spring MVC나 REST 클라이언트 쪽에서도 기본으로 등록되어 동작
- 기본적으로 프레임워크에서 여러 미디어 타입을 지원하는 `HttpMessageConverter` 구현체들이 제공되고, `supportedMediaTypes` 속성을 통해 변환 가능한 미디어 타입을 조정할 수 있음

<br>

## 주요 HttpMessageConverter 구현체 및 특징

#### 1. `StringHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ `String`
- text 계열 미디어 타입(예: `text/plain`)을 읽고 씀

<br>

#### 2. `FormHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ `MultiValueMap<Stinrg, String>` 등 폼 데이터
- `application/x-www-form-urlencoded` 읽기/쓰기 지원, 쓰기 시 `multipart/form-data` 일부 지원 가능

<br>

#### 3. `ByteArrayHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ `byte[]`
- 모든 미디어 타입(`*/*`)을 읽고 쓸 수 있음
- 기본 `content-type`은 `application/octet-stream`

<br>

#### 4. `MarshallingHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ XML 바인딩 객체
- Spring의 `Marshaller` / `Unmarshaller` 인터페이스를 사용해 XML ↔️ 객체 변환
- 기본 미디어 타입은 `application/xml`, `text/xml`

<br>

#### 5. `MappingJackson2HttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ 객체 ↔️ JSON
- Jackson의 XML 확장 모듈 사용, 기본 지원 타입 `application/json`

<br>

#### 6. `MappingJackson2XmlHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ 객체 ↔️ XML(Jackson XML)
- Jackson의 XML 확장 모듈 사용, 기본 지원 타입 `application/xml`

<br>

#### 7. `GsonHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ 객체 ↔️ JSON(GSON)
- Google의 Gson 라이브러리 사용, `com.google.code.gson` 라이브러리 필요

<br>

#### 8. `JsonbHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ 객체 ↔️ JSON(JSON-B)
- Jakarta JSON Bind API 사용, 구현체 필요 

<br>

#### 9. `ProtobufHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ Protocol Buffers 메시지
- `application/x-protobuf` 미디어 타입 지원

<br>

#### 10. `ProtobufJsonFormatHttpMessageConverter`

- protobuf ↔️ JSON
- Protobuf 메시지와 JSON 간 변환 가능

<br>

#### 11. `SourceHttpMessageConverter`

- 읽기/쓰기 대상 타입 ➡️ `javax.xml/transform.Source`
- `DOMSource`, `SAXSource`, `StreamSource` 등 지원, 기본 타입: `text/xml`, `application/xml`

<br>

## 설정 / 확장 지점 & 동작 방식

- `HttpMessageConverter` 구현체들은 `RequestMappingjHandlerAdapter`가 관리하고 컨트롤러의 `@RequestBody` 또는 `@ResponseBody` 처리가 필요할 때 자동으로 사용
- 개발자가 직접 `supportedMediaTypes`를 조정해 변환 가능한 미디어 타입 범위를 좁히거나 확장할 수 있음
- 만약 기본 제공 변환기가 충분하지 않으면, 사용자 정의 `HttpMessageConverter`를 빈으로 등록해서 기능을 추가할 수 있음
- 변환기 순서가 중요할 수 있는데, 먼저 적합한 변환기가 요청/응답 미디어 타입을 처리 가능한지 테스트하고, 가능하면 그 변환기가 선택
- 기본 제공 변환기는 프레임워크 내부에서 미리 등록되어 자동으로 동작하기 하지만, 커스터마이징이 가능하도록 구조가 열려 있음

<br>

## 요약

> Spring의 `HttpMessageConverter` 메커니즘은 HTTP 요청/응답의 본문을 객체 ↔️ 직렬화된 형식 사이에서 자동 변환해주며, 여러 기본 구현체가 제공되고 개발자가 필요하면 직접 구현체를 추가하거나 미디어 타입 설정을 조정할 수 있도록 설계되어 있음

