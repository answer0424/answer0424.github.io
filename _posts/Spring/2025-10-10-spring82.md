---
layout: post
title: Multipart Forms
date: 2025-10-10 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, Controller, Handler Method]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## MultipartResolver 활성화 후 동작

- `MultipartResolver` 빈이 활성화되어 있다면, `multipart/form-data` 형식의 POST 요청 내용이 자동으로 파싱됨
- 이렇게 파싱된 내용은 일반 요청 파라미터처럼 접근 가능해짐
- 즉, 파일과 일반 입력 필드가 함께 있는 폼도 `@RequestParam` 방식으로 받을 수 있음

<br>

## 컨트롤러 메서드 예시

```java
@Controller
public class FileUploadController {
    @PostMapping("/form")
    public String handleFormUpload(
        @RequestParam("name") String name,
        @RequestParam("file") MultipartFile file) 
    ) {
        if(!file.isEmpty()) {
            byte[] bytes = file.getBytes();
            // 파일 처리 로직
            return "redirect:uploadSuccess";
        }
        return "redirect:uploadFailure";
    }
}
```

- `name` 필드는 일반 텍스트 입력 필드로 받고
- `file`은 `MultipartFile` 타입으로 파일 업로드 항목을 받음
- 파일이 비어 있지 않다면 `getBytes()` 등으로 바이트 배열로 읽어서 저장 가능

<br>

## 여러 파일 또는 파일 맵 받기

- 동일한 파라미터 이름으로 여러 파일을 제출하면, `List<MultipartFile>` 타입을 메서드 파라미터로 선언해 받을 수 있음
- `@RequestParam`을 `Map<String, MultipartFile>` 또는 `MultiValueMap<String, MultipartFile>`로 선언하면 파라미터 이름별 파일들을 맵 형태로 받을 수 있음

<br>

## `Part` 인터페이스 사용

- `MultipartFile` 대신 `jakarta.servlet.http.Part` 타입을 메서드 인자로 쓸 수도 있음
- 즉, 표준 Servlet API 방식으로 파일 파트를 제어하고 싶을 때 유용

<br>

## 폼 객체 내부 바인딩으로 처리

- 파일 + 다른 입력 필드를 하나의 폼 객체로 묶어서 받는 것도 가능
- 예: 폼 클래스에 `String name` 필드 + `MultipartFile file` 필드를 두고, 컨트롤러 메서드는 `public String upload(MyForm form)`처럼 선언 가능
