---
layout: post
title: ResponseEntity
date: 2025-10-13 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, Controller, Handler Method]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- `ResponseEntity<T>`는 `@ResponseBody`와 유사하게 반환 객체를 응답 본문으로 직렬화하지만, HTTP 상태 코드와 응답 헤더도 함께 제어할 수 있는 기능을 제공
- 즉, `@ResponseBody` + 상태/헤더 제어 기능의 조합이라고 생각할 수 있음
- 반환 타입이 `ResponseEntity<Resource>` 인 경우 파일 스트리밍 응답을 구현할 수 있음
- 비동기 방식 또는 리액티브 타입을 지원하여 상태/헤더와 본문을 비동기적으로 처리 할 수 있음

<br>


## 기본 예제 코드

```java
@GetMapping("/something")
public ResponseEntity<String> handle() {
    String body = ... ;
    String etag = ... ;
    return ResponseEntity
        .ok()
        .eTag(etag)
        .body(body);
}
```

- `ResponseEntity.ok()`는 HTTP 상태 200을 설정한 `ResponseEntity.BodyBuilder`를 반환
- `.eTag(etag)`는 응답 헤더에 ETag 값을 추가
- `.body(body)`는 응답 본문을 설정하고 최종 `ResponseEntity` 객체를 생성

<br>

## 파일 응답 예시

- `ResponseEntity<Resource>` 형태를 사용하면, 파일 컨텐츠를 스트리밍 방식으로 응답 본문에 전송할 수 있음
- 단, `InputStreamResource` 등을 사용할 때는 본문의 `InputStream`을 지연 방식으로 열도록 설계하여 응답 스트리밍이 끝난 뒤 리소스를 닫을 수 있게 해야 함
- 만약 커스텀 `InputStreamResource`를 사용하는 경우에는 `contentLength()` 메서드를 적절히 구현해야 함

<br>

## 리액티브 & 비동기 응답 지원

- `ResponseEntity<Mono<T>>` 또는 `ResponseEntity<Flux<T>>`를 반환하면, 응답의 상태와 헤더는 즉시 결정되고 본문은 비동기적으로 제공
- `Mono<ResponseEntity<T>>`는 상태, 헤더, 본문 모두를 비동기적으로 결정할 수 있게 해줌

<br>

## 요약 정리

| 항목 | 설명 |
|---|---|
| 기능 | 반환 객체를 응답 본문으로 전송하면서 상태 코드와 헤더를 함께 제어 |
| 주요 메서드 체인 | `ResponseEntity.ok()`, `.status()`, `.header()`, `eTag()`, `.body()` 등 |
| 파일 응답 지원 | `ResponseEntity<Resource>` 형태로 파일 스트림 전송 가능 |
| 비동기/리액티브 지원 | `ResponseEntity<Mono<T>>`, `ResponseEntity<Flux<T>>` 등으로 비동기 본문 처리 가능 |
| 응답 직렬화 | 내부적으로 `HttpMessageConverter`가 본문 객체를 JSON/XML 등으로 변환 |