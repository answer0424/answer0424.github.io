---
layout: post
title: Jackson JSON
date: 2025-10-13 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, Controller, Handler Method]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## Jackson 연동 및 목적

- Spring MVC는 Jackson 라이브러리에 대한 내장 지원을 제공
- 이 지원 덕분에, `@ResponseBody` 또는 `ResponseEntity` 방식의 컨트롤러 메서드에서 반환된 객체는 자동으로 JSON으로 직렬화 가능
- 특히 문서에서는 "JSON Views" 기능을 중심으로 Jackson과의 통합을 설명함

<br>

## JSON Views(`@JsonView`) 기능

> Jackson의 Serialization Views 기능을 통해, 객체의 일부 필드만 선택적으로 JSON으로 노출할 수 있음
>
> 즉, 동일 객체라도 어떤 뷰를 선택하느냐에 따라 직렬화되는 필드가 달라질 수 있음

#### 1. 컨트롤러 메서드에 `@JsonView`  지정


```java
@RestController
public class UserController {
    @GetMapping("/user")
    @JsonView(User.WithoutPassword.class)
    public User getUser() {
        return new User("eric", "password123");
    }
}
```

- 이 메서드는 `User` 객체를 반환하지만, `@JsonView(User.WithoutPassword.class)` 덕분에 지정한 뷰의 조건에 맞는 필드만 JSON 응답에 포함

<br>

#### 2. 뷰 인터페이스 정의 및 필드에 언노테이션 달기

```java
public class User {
    public interface WithoutPassword {}
    public interface WithPasswordView extends WithoutPasswordView {}

    private String username;
    private String password;

    public User() {}
    public User(String username, String password) {

        this.username = username;
        this.password = password;
    }

    @JsonView(WithoutPassword.class)
    public String getUsername() {
        return this.username;
    }
    
    @JsonView(WithoutPassword.class)
    public String getPassword() {
        return this.password;
    }
}
```

- `@JsonView(WithoutPassword.class)`가 `getUsername()`에 붙어 있으므로, `WithoutPassword` 뷰에서는 `username` 필드는 포함
- `password` 필드는 `WithPasswordView` 뷰가 활성화될 때만 포함
- `WithoutPassword`는 `WithoutPasswordView`를 상속하므로, `WithPasswordView` 뷰를 사용하면 `username` + `password` 모두 노출됨
  
<br>

#### 3. 프로그램적으로 뷰 지정하기 - `MappingJacksonValue`

```java
@RestController
public class UserController {
    @GetMapping("/user")
    public MappingJacksonValue getUser() {
        User user = new User("eric", "password123");
        MappingJacksonValue value = new MappingJacksonValue(user);
        value.setSerializationView(User.WithoutPassword.class);
        return value;
    }
}
```

- `MappingJacksonValue` 객체를 반환하면서 뷰 클래스를 설정하면, 해당 뷰 기준으로 직렬화가 수행
- 해당 방법은 컨트롤러 로직에서 조건에 따라 뷰를 선택해야 할 때 유용

<br>

## 주의사항 / 제한점

- `@JsonView` 어노테이션은 하나의 뷰 클래스만 지정할 수 있음, 배열 형태로 여러 뷰를 지정해도 첫번째만 유효하게 사용
- 다중 뷰를 사용하고 싶다면 뷰 상속 구조를 활용해 계층적으로 설계해야 함
- 예를 들어 `WithPasswordView`가 `WithoutPasswordView`를 확장하는 형태로 구성할 수 있음
- Jackson 뷰 기능은 직렬화된 JSON의 필드 노출을 제어할 뿐이며, 역직렬화에 대해서는 똑같이 동작하지 않을 수 있음