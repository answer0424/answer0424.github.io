---
layout: post
title: Model
date: 2025-10-13 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, Controller]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## @ModelAttribute 개요 및 역할

- 컨트롤러 메서드의 파라미터
  - 요청 처리 메서드의 파라미터로 사용되어 모델 객체를 가져오거나 바인딩을 수행하고, 요청 파라미터를 객체 필드에 바인딩함
- 컨트롤러 혹은 @ControllerAdvice 클래스의 메서드 수준
  - 요청을 처리하기 전에 모델을 초기화하거나 공통 모델 속성을 추가하는 역할
- @RequestMapping 메서드 자체에 부여
  - 보통 뷰 기반 컨트롤러에서 메서드의 반환값을 모델 속성으로 해석하여 할 때 사용됨

<br>

## @ModelAttribute 메서드 동작 방식

- 같은 컨트롤러 안에 여러 개의 `@ModelAttribute` 메서드를 둘 수 있으며, 이들은 해당 컨트롤러의 `@RequestMapping` 메서드가 호출되기 전에 모두 실행됨
- 또한 `@ControllerAdvice`를 통해 여러 컨트롤러에 공통으로 적용되는 `@ModelAttribute` 메서드를 설정할 수도 있음
- `@ModelAttribute` 메서드는 다양한 시그니처를 가질 수 있으며, `@RequestMapping` 메서드에서 사용 가능한 대부분의 인자 유형을 지원
  - 다만, 요청 본문 관련 파라미터는 사용할 수 없음
- 메서드 수준 `@ModelAttribute`는 주로 모델 초기값을 넣거나, 공통 속성을 미리 채워두는 데 사용

<br>


## 예제 코드

#### 복수 속성 초기화하는 `@ModelAttribute` 메서드

```java
@Controller
public class AccountController {
    @ModelAttribute
    public void populateModel(@RequestParam String number, Model model) {
        Account acct = accountREpository.findAccount(number);
        model.addAttribute("account", acct);
        // 필요한 다른 속성들도 추가할 수 있음
    }

    @RequestMapping("/show")
    public String showPage(/* ... */) {
        // 이 시점에서 model에는 "account" 속성이 이미 채워져 있음
        return "accountView";
    }
}
```

- 위 예제에서 `populateModel(...)` 메서드는 컨트롤러의 어떤 요청 매핑 메서드보다 먼저 호출되어, 모델에 `account` 속성을 미리 추가
- 이후에 `@RequestMapping("/show")`가 호출되면, 컨트롤러 메서드 내부에서는 이 속성이 이미 모델에 존재하게 됨

<br>

#### 단일 속성 반환형 방식

```java
@Controller
public class AccountController {
    @ModelAttribute
    public Account addAccount(@RequestParam String number) {
        return accountRepository.findAccount(number);
    }

    @RequestMapping("/show")
    public String show(Model model) {
        // 이 시점에서 모델에는 "account" 속성이 있음
        // 또는 메서드 반환에 따라 이름을 변경 가능
        return "accountView";
    }
}
```

- 이 방식에서는 `@ModelAttribute` 메서드가 `Account` 객체를 반환하고 Spring 기본 이름 규칙을 이용하여 모델에 삽입
- 만약 모델 속성 이름을 명시하고 싶다면 `@ModelAttribute("myAccount")`처럼 어노테이션 `name` 속성을 줄 수 있음

<br>

#### @ModelAttribute on @RequestMapping 메서드

```java
@GetMapping("/accounts/{id}")
@ModelAttribute("myAccount")
public Account handle() {
    return accountService.findById(id);
}
```

- 이 경우, `handle()` 메서드의 반환 객체가 자동으로 모델 속성이 되며, 뷰에서 "myAccount"라는 이름으로 참조
- 다만, 이 방식을 뷰 기반 컨트롤러에서 주로 사용되며, RES API 방식의 컨트롤러에서는 보통 사용되지 않음

<br>

## 요약 

| 포인트 | 설명 |
|---|---|
| 호출 시점 | `@RequestMapping` 처리가 시작되기 전에 `@ModelAttribute` 메서드가 먼저 실행 |
| 모델 초기화 | 공통 속성, 기본 데이터 등을 미리 모델에 넣는 데 유용 |
| 여러 개 가능 | 컨트롤러마다 또는 `@ControllerAdvice`로 여러 `@ModelAttribute` 메서드를 정의 가능 |
| 유연한 파라미터 | `@RequestParam`, `Model`, 기타 바인딩 가능한 인자들을 받을 수 있음 |
| 속성 이름 지정 | 반환 방식 또는 `name` 속성을 통해 모델 속성 이름을 명시 가능 |
| 적합한 용도 | 뷰 렌더링 방식의 컨트롤러에서 자주 사용되며, REST API 컨트롤러에서는 덜 사용됨 |