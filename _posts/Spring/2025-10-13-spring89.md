---
layout: post
title: InitBinder
date: 2025-10-13 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, Controller]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## `@InitBinder` 개요 및 역할

- `@InitBinder`는 Spring MVC 컨트롤러 내에서 `WebDataBinder` 인스턴스를 초기화하거나 설정하는 데 사용하는 메서드용 어노테이션
- `WebDataBinder`는 클라이언트 요청 파라미터를 모델 객체에 바인딩하고, 타입 변화이나 포맷을 적용하는 역할
- `@InitBinder` 메서드를 통해 아래와 같은 작업들을 수행 가능
  - `PropertyEditor`, `Converter`, `Formatter` 등록
  - 허용 필드, 비허용 필드 설정 ➡️ 보안 상 예기치 않은 필드 바인딩 방지
  - 선언적 바인딩 옵션 설정 (예: `declarativeBinding`)
- `@InitBinder` 메서드는 `@Controller` 내에 있을 경우 해당 컨트롤러 범위에만 영향을 미치고, `@ControllerAdvice`에 있을 경우 여러 컨트롤러에 공통적으로 적용할 수 있음

<br>

## 동작 방식 및 주의점

- `@InitBinder` 메서드는 `@RequestMapping` 등의 요청 처리 메서드보다 먼저 실행됨
- `@InitBinder` 메서드는 `WebDataBinder`를 파라미터로 받고 반환값은 `void`가 일반적
- `@InitBinder` 메서드는 `@ModelAttribute` 파라미터 유형은 사용할 수 없음
- `@InitBinder` 메서드는 다양한 인자 타입을 허용하는데 여컨대 `WebRequest`, `Locale`, `WebDataBinder` 등이 가능

<br>

## 예제 코드

```java
@Controller
public class FormController {
    @InitBinder
    public void initBinder(WebDataBinder binder) {
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        dateFormat.setLenient(false);
        binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, false));
    }

    // 이후의 @RequestMapping 메서드들에서는 이 바인더 설정이 적용됨
}
```

 또는 `Formatter` 기반으로 설정을 사용하는 경우


 ```java
 @Controller
 public class FormController {
    @InitBinder
    protected void initBinder(WebDataBinder binder) {
        binder.addCustomFormatter(new MyCustomFormatter("yyyy-MM-dd"));
    }
 }

 ```

 <br>

 ## 보안 및 모델 객체 설계 관점에서 권장 사항

- 웹 요청 데이터 바인딩은 클라이언트가 임의의 파라미터를 보내 객체의 의도하지 않은 필드에 값을 주입할 수 있는 위험성을 내포
- 권장 방식은 도메인 엔티티를 직접 바인딩 대상으로 사용하기보다는 웹 전용 DTO나 폼 객체를 만드는 것
- 만약 전통적인 프로퍼티 바인딩을 사용해야 하는 경우라면, `binder.setAlloiwedFields(...)` 등을 통해 허용할 필드 목록을 명시적으로 설정하여 예기치 않은 필드 바인딩을 방지하는 것이 좋음

```java
@Controller
public class ChangeEmailController {
    @InitBinder
    public void initBinder(WebDataBinder binder) {
        binder.setAllowedFields("oldEmailAddress",  "newEmailAddress");
    }

    // @RequestMapping 메서드들...
}
```
- 또한 `disallowedFields` 옵션도 사용할 수 있으나, `allowedFields` 방식이 더 명시적이고 안전함
- 바인딩 방식 자체를 제한하고 싶다면, `binder.setDeclarativeBinding(false)`를 사용해 선언적 바인딩 모드만 허용할 수도 있음
