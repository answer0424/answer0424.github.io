---
layout: post
title: Web Security
date: 2025-10-15 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

> Spring Security는 웹 어플리케이션을 악의적인 공격으로부터 보호하는 기능을 제공
>
> 주요 기능으로 인증(Authentication), 권한 부여 (Authorization), CSRF(Cross-Site Request Forgery) 보호, 보안 응답 헤더 설정 등이 있음

<br>

## Spring MVC와 Spring Security 통합

#### 1. `@EnableWebSecurity` 사용

- Spring Security와 Spring MVC를 통합하려면, `@EnableWebSecurity` 어노테이션을 사용하여 보안 구성을 활성화
- 이 어노테이션은 Spring MVC의 기능을 기반으로 보안 구성을 제공
- 만약 `WebMvcConfigurationSupport`를 직접 사용하는 경우, Spring Security 구성을 수동으로 제공해야 함

<br>

#### 2. `PathPatternRequestMatcher` 사용

- Spring Security는 Spring MVC의 URL 매칭 방식과 깊은 통합을 제공
- 이를 통해 보안 규칙이 요청 처리 로직과 일치하도록 할 수 있음
- `PathPatternRequestMatcher`는 Spring MVC의 `PathPatternParser`와 동일한 파서를 사용해야 하므로, 이를 설정하려면 `PathPatternRequestMatcherBuilderFactoryBean`을 빈으로 등록해야 함

<br>

#### 3. `@AuthenticationPrioncipal` 사용

- Spring Security는 `AuthenticationPrincipalArgumentResolver`를 제공하여, Spring MVC의 메서드 매개변수에서 현재 인증된 사용자를 자동으로 주입할 수 있음
- `@EnabledWebSecurity`를 사용하면 이 기능이 자동으로 활성화됨
- XML 기반 구성에서는 `AuthenticationPrincipalArgumentResolver`를 수동으로 등록해야 함

<br>

## 보안 기능 설정

- 폼 기반 로그인: 기본 로그인 폼을 제공하며, 사용자 정의 로그인 페이지를 설정할 수도 있음
- 로그아웃 기능: 로그아웃 URL을 설정하고, 로그아웃 후 리다이렉션할 페이지를 지정할 수 있음
- CSRF 보호: 기본적으로 CSRF 보호가 활성화되어 있으며, 필요에 따라 비활성화 가능
- 보안 응답 헤더: HTTP Strict Transport Security(HSTS), X-Content-Type-Options, X-XSS-Protection, X-Frame-Options 등의 보안 헤더를 자동으로 설정

<br>

## Spring MVC 테스트 지원

> Spring Security는 Spring MVC 테스트와의 통합을 지원
>
> 이를 통해 보안이 적용된 컨트롤러를 테스트할 수 있음
>
> 테스트 설정 시 `SecurityMockMvcConfigurers.springSecurity()`를 적용하여 보안 구성을 포함시킬 수 있음