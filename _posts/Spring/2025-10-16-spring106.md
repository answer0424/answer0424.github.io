---
layout: post
title: Document Views
date: 2025-10-16 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, View Technologies]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- 기본적으로 Spring MVC는 HTML 뷰가 아닌 문서 형식 응답을 생성할 수 있는 기능을 제공
- 클라이언트가 스프레드시트나 PDF 리더로 결과를 열람해야 할 경우가 많기 떄문에 모델 데이터를 기반으로 문서를 동적으로 생성하여 스트리밍 응답으로 전송할 수 있게 해줌
- Excel 뷰를 사용하려면 Apache POI 라이브러리가 필요하고 PDF 뷰를 사용하려면 OpenPDF 같은 라이브러리가 필요

<br>

## PDF 뷰

- Spring은 `AbstractPdfView` 클래스를 제공하며, 이를 상속하여 `buildPdfDocument` 메서드를 구현하면 PDF 응답을 생성할 수 있음

```java
public class PdfWordList extends AbstractPdfView {
    @Override
    protected void buildPdfDocument(
        Map<String, Object> model,
        Document document,
        PdfWriter writer,
        HttpServletRequest request,
        HttpServletResponse response
    ) throws Exception {
        @SuppressWarnings("unchecked")
        List<String> words = (List<String>) model.get("wordList");
        for (String word : words) {
            document.add(new Paragraph(word));
        }
    }
}
```

<br>

## 요약 & 활용 팁

| 항목 | 요약 |
|-|-|
| 문서 뷰 지원 | PDF 및 Excel 문서 응답을 생성할 수 있는 뷰 기능 제공 |
| 기반 클래스 | `AbstractPdfView`, `AbstractXlsView` 제공 |
| 라이브러리 필요 | PFD: OpenPDF, Excel: Apache POI 필요 |
| 컨트롤러 반환 방식 | 뷰 이름 또는 `View` 인스턴스를 반환 가능 |
| 보안 고려 | PDF 라이브러리는 보안 취약점이 있을 수 있으므로 최신 라이브러리 사용 권장 |
