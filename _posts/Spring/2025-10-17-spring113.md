---
layout: post
title: Content Type
date: 2025-10-17 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, MVC config]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개념 및 목적

- Content Negotiation은 클라이언트가 요청 시 원하는 응답 미디어 타입을 서버에게 알려주고 서버는 그에 맞는 표현으로 응답하는 메커니즘
- Spring MVC는 기본적으로 `Accept` 헤더를 기준으로 미디어 타입을 판단
- 즉, 클라이언트가 `Accept: application/json` 헤더를 보내면 JSON 응답을 선택하게 됨
- 하지만 URL 확장자, 쿼리 파라미터, 헤더 외의 방식 등을 기반으로 미디어 타입을 결정하도록 설정을 변경할 수 있음

<br>

## Spring에서의 설정 방법

```java
@Configuration
public class WebConfiguration implements WebMvcConfigurer {
    @Override
    public void configureContentNegotiation(ContentNegotiationConfigurer configurer) {
        configurer
            .mediaType("json", MediaType.APPLICATION_JSON)
            .mediaTpye("xml", MediaType.APPLICATION_XML);
    }
}
```

- 위 예제는 URL 확장자 `"json"` ➡️ `application/json`, `"xml"` ➡️ `application/xml` 매핑을 추가한 것
- 이 설정 외에도 `favorParameter(true)`나 쿼리 파라미터 이름을 지정할 수 있으며, 이를 통해 `?format=json` 같은 요청 방식도 허용할 수 있음

```xml
<mvc:annotation-driven content-negotiation-manager="contentNegotiationManager"/>

<bean id="contentNegotiationManager"
      class="org.springframework.web.accept.ContentNegotiationManagerFactoryBean">
  <property name="mediaTypes">
    <value>json=application/json, xml=application/xml</value>
  </property>
</bean>
```

- XML 구성 방식에서는 `ContentNegotiationManagerFactoryBean`을 정의하고 `mediaTypes` 속성에 확장자 ↔️ 미디어 타입 매핑을 설정
- 그 후 `<mvc:annotation-driven>`에 `content-negotiation-manager` 속성으로 연결