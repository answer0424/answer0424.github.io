---
layout: post
title: Annotated Controller
date: 2025-10-23 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, WebSockets, STOMP]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

##  주요 어노테이션 및 사용 방법

#### 1. `@MessageMapping`

- 이 어노테이션을 사용하면 클라이언트가 보내는 STOMP 목적지에 따라 해당 메서드를 호출할 수 있음
- 클래스 레벨에도 붙일 수 있어서, 컨트롤러 전체에 공통된 경로 접두사를 지정할 수 있음
- 기본적으로 값에는 Ant 스타일 경로 패턴이 들어감 (`"/chat/{roomId}"`, `"/topic/**"` 등)

###### 메서드 인자 지원

- `Message<?> message`: 전체 메시지 객체
- `MessageHeaders headers`: 메시지 헤더 맵
- `SimpMessageHeaderAccessor`, `StompHeaderAccessor`: 헤더 정보를 타입 세이프하게 다룰 수 있는 도구
- `@Payload T payload`: 메시지 본문을 변환하여 바인딩 `@Valid` 또는 `@Validated`와 함께 유효성 검사 가능
- `@Header("someHeader") Foo headerValue`: 특정 헤더값 취득
- `@Headers Map<String, Object> allHeaders`: 모든 헤더 맵을 취득 가능
- `@DestinationVariable String var`: 경로 변수로 지정된 템플릿 변수 추출 (예: `/chat/{roomId}`에서 `roomId` 추출)
- `Principal principal`: WebSocket 핸드셰이크 당시 연결된 사용자의 인증 추세