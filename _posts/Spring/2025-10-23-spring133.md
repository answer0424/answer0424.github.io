---
layout: post
title: Sending Messsages
date: 2025-10-23 09:00:00 +09:00
categories: [Spring, Servlet Stack, Web MVC, WebSockets, STOMP]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---


## 개요

- STOMP over WebSocket 환경에서, 클라이언트가 보낸 메시지뿐 아니라 어플리케이션의 임의의 위치에서도 연결된 클라이언트로 메시지를 보낼 필요가 있음
- 이러한 서버 ➡️ 클라이언트 메시징을 어떻게 구현할 수 있는지 설명할 예정
- 핵심 방법 `SimpMessagingTemplate`를 주입받아 사용하며, 이 객체를 통해 목적지로 메시지를 전송할 수 있음

<br>

## 사용 방법 및 코드 예제

```java
@Controller
public class GreetingController {
    
    private final SimpMessagingTemplate template;

    @Autowired
    public GreetingController(SimpMessagingTemplate template) {
        this.template = template;
    }

    @RequestMapping(path="/greeting", method=POST)
    public void greet(String greeting) {
        String text = "[" + getTimestamp() + "] " + greeting;
        this.template.convertAndSend("/topic/greetings", text);
    }
}
```

- 위 예제에서 `/greeting` HTTP 요청이 들어오면 서버는 `template.converAndSend()`를 통해 `/topic/greetings` 목적지로 메시지를 발송
- 클라이언트는 STOMP로 `/topic/greetings`를 구독하고 있으면 이 메시지를 수신하게 됨

<br>

## 활용 시나리오 및 팁

- 사용자가 버튼을 눌렀을 때 클라이언트에 알림을 보내고 싶을 경우, HTTP 컨트롤러 + `SimpMessagingTemplate` 조합을 사용
- 비-HTTP 이벤트에서 WebSocket 클라이언트로 알림을 보내야 한다면, 해당 서비스에서 `SimpMessagingTemplate`를 주입해 사용하면됨
- 목적지 설계 시, 구독과 일관성을 갖도록 `/topic/` 또는 `/queue/` 접두사를 활용하는 것이 좋음
- 많은 클라이언트에게 동시에 메시지를 보낼 경우, 내부 브로커(`enableSimpleBroker`)의 성능 한계를 고려해야 함. 필요시 외부 메시지 브로커 연동을 검토