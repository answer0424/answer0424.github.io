---
layout: post
title: SessionAttributes
date: 2025-11-17 09:00:00 +09:00
categories: [Spring, Reactive Stack, WebFlux, Annotated Controllers]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- `@SessionAttribute` 어노테이션은 컨트롤러 클래스 레벨에 적용되며, 해당 컨트롤러에서 사용되는 모델 속성을 HTTP 서블릿 세션 등에 저장해 여러 요청 간에 공유할 수 있도록 선언하는 목적
- 즉, 첫 요청 시 모델에 추가된 속성이 `@SessionAttribute`에서 지정된 이름 또는 타입이면 자ㅏ동으로 세션에 저장되고, 이후 동일 컨트롤러 내 혹은 매핑된 메서드에서 다시 꺼내 사용할 수 있

<br>

## 사용법 및 예제

```java
@Controller
@SessionAttributes("pet")  // "pet"이라는 모델 속성을 세션에 저장하도록 지정
public class EditPetForm {

    @ModelAttribute("pet")
    public Pet setupPetForm() {
        return new Pet();  // 새로운 Pet 객체 생성 후 모델에 추가
    }

    @PostMapping("/pets/{id}")
    public String processSubmit(@ModelAttribute("pet") Pet pet,
                                BindingResult result,
                                SessionStatus status) {
        if (result.hasErrors()) {
            return "petForm";
        }
        // 처리 완료 후 세션에 저장된 모델 속성 삭제
        status.setComplete();
        return "redirect:/pets";
    }
}
```

- 위 코드에서 `@SessionAttributes("pet")` 덕분에 `setupPetForm()` 메서드로 생성된 `pet` 객체가 모델에 담긴 이후 자동으로 세션에 저장됨
- 이후 `processSubmit()` 메서드에서 `@ModelAttribute("pet") Pet pet` 인자로 `pet` 객체가 세션-모델에서 꺼내져 바인딩 됨
- `SessionStatus status` 인자를 통해 해당 세션에 저장된 모델 속성을 명시적으로 완료 처리하고 세션에서 제거할 수 있음

<br>

## 특징 및 사용 시 고려사항

- `@SessionAttributes`는 임시 대화형 상태 유지에 적합하며, 영구적인 세션 저장이 필요한 사용자 인증 정보 등을 위해서는 `HttpSession.setAttribute()` 방식이 권장됨
  - 문서에서는 "permanent sessionm attributes ... use the traditional session.setAttribute method"라고 명시
- 세션에 저장된 모델 속성은 컨트롤러 간 공유될 수도 있고, 동일 컨트롤러 내 여러 요청 간에 재사용될 수 있음
- 세션에서 해당 모델 속성을 제거하고 싶다면, 컨트롤러 메서드 인자에 `SessionStatus`를 선언하고 `status.setComplete()`를 호출하면 됨
  - 그렇지 않으면 해당 속성이 세션에 계속 남아 있을 수 있음
- `@SessionAttributes`에 지정된 이름과 실제 모델에 담긴 속성 이름이 일치해야 자동 저장 기능이 동작함
  - 즉, `@SessionAttributes("pet")`이 선언된 경우, 모델에 `"pet"`이라는 이름으로 `Pet` 객체가 존재해야 함
- `@ModelAttribute`를 이용해 폼 바인딩과 같이 여러 단계에 걸치 화면 흐름에서 상태를 유지하고자 할 때 유용