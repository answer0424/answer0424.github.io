---
layout: post
title: RedirectAttributes
date: 2025-11-17 09:00:00 +09:00
categories: [Spring, Reactive Stack, WebFlux, Annotated Controllers]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- 컨트롤러 메서드에서 리다이렉트 할 때, 리다이렉트 대상으로 어떻게 데이터를 전달할지에 대한 설명
- 기본적으로 모델에 담긴 속서들이 리다이렉트 URL의 URI 템플릿 변수나 쿼리 파라미터로 자동 노출되는 동작이 있음
- 하지만 이 자동 노출이 항상 바람직한 것은 아니며, 불필요한 모델 속성이 URL에 노출되는 것을 막기 위해 리다이렉트 전용 속성 처리 방식이 제공

<br>

## 동작 방식 및 예제

#### 기본 동작

- 컨트롤러에서 `return "redirect:/someUrl";` 형태로 리다이렉트 하면
  - 현재 모델에 담겨 있는 속성 중
    - URI 템플릿 변수와 매칭되는 것들은 자동으로 URL 경로 템플릿 변수로 치환됨
    - 나머지 중 기본 타입 혹은 primitive 타입 컬렉션/배열인 속성들은 자동으로 쿼리 파라미터 형태로 URL 뒤에 붙음
- 예를 들어 모델에 `id=5`와 `name="Spring"`이 담겨있다면, `redirect:/view`로 리턴했을 때 실제 리다이렉트 URL이 `/view?id=5&name=Spring` 형태가 됨

<br>

#### 리다이렉트 속성 제어

- 불필요한 속성이 URL에 노출되는 것을 막기 위해, 메서드 인자로 RedirectAttributes 타입을 선언할 수 있음

```java
@PostMapping("/submit")
public String handleSubmit(RedirectAttributes attrs) {
    attrs.addAttribute("id", saveId);
    attrs.addFlashAttribute("message", "Saved");
    return "redirect:/view/";
}
```

- `addAttribute()` 로 추가된 항목은 URL의 쿼리 파라미터로 노출됨
- `addFlashAttribute()`로 추가된 항목은 URL에 노출되지 않고 세션 기반 스토리지에 잠깐 저장돼 리다이렉트 후 다음 요청에서 모델로 자동 제공됨

<br>

#### 설정 플래그

- `RequestMappingHandlerAdapter`에는 `ignoreDefaultModelOnRedirect` 플래그가 있음
  - `false`이면 리다이렉트 시 기본 모델에 담긴 모든 속성이 고려됨
  - `true`로 설정하면, 리다이렉트 시 모델이 아닌 `RedirectAttributes`만을 이용해 전달할 속성을 지정해야 함
- 새로 시작하는 어플리케이션에서는 `ignoreDefaultModelOnRedirect` 설정을 권장한다고 언급됨

<br>

## 요약 및 팁

- 리다리렉트 후 전달할 데이터가 URL 쿼리 파라미터로 노출되어도 괜찮은 경우에는 `addAttribute()` 혹은 모델 속성으로 처리해도 무방
- 그러나 전달할 데이터가 URL에 노출되면 안되는 경우에는 `addFlashAttribute()` 방식을 사용하는 것이 바람직함
- 컨트롤러 메서드에 `RedirectAttributes` 인자를 명시적으로 사용하는 것이 명확하고 안전한 방식
- URL에 기본 모델이 자동 노출되는 것을 원치 않는다면 `igonreDefaultModelOnRedirect=true` 설정을 적용하는 것이 좋음
- 리다이렉트 대상 URL내에 `/{var}` 형태의 URI 템플릿 변수가 있다면 해당 변수명과 동일한 모델 속성이나 `addAttribute()` 속성이 자동으로 치환됨