---
layout: post
title: Flash Atttributes
date: 2025-11-17 09:00:00 +09:00
categories: [Spring, Reactive Stack, WebFlux, Annotated Controllers, Handler Methods]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- 플래시 속성은 한 요청에서 저장된 데이터를 다음 요청에서만 사용하는 기능
- 주로 리다이렉트 시나리오, 즉 POST ➡️ Redirect ➡️ Get 패턴에서 사용됨
- 동작 방식:
  1. 리다이렉트 이전 요청에서 플래시 속성을 저장
  2. 리다이렉트 이후의 요청에서 이속성을 모델에 자동 추가
  3. 속성 사용 후 즉시 제거됨 ➡️ 일회성 데이터 전달 용도에 적합
- FlashMap - 플래시 속성 저장소 객체, "FlashMapManager"` - 이 저장소를 관리하는 역할이란 추상화가 제공됨
- 플래시 속성 기능은 별도의 설정 없이 항상 활성화되어 있으며, 사용하지 않을 경우 세션 생성도 하지 않음

<br>

## 사용법 및 예제


```java
@Controller
public class UploadController {

    @PostMapping("/upload")
    public String handleUpload(RedirectAttributes redirectAttributes) {
        // 파일 업로드 처리 로직 …
        redirectAttributes.addFlashAttribute("message", "파일 업로드 성공!");
        return "redirect:/uploadStatus";
    }

    @GetMapping("/uploadStatus")
    public String uploadStatus(Model model) {
        // 리다이렉트 이후 요청에서 "message" 플래시 속성이 모델에 자동 추가됨
        if (model.containsAttribute("message")) {
            String msg = (String) model.getAttribute("message");
            // 메시지 활용 …
        }
        return "uploadStatusView";
    }
}
```

- `redirectAttributes.addFlashAttribute("message", "...")` ➡️ 리다이렉트 이후 요청에서 사용 가능한 플래시 속성 저장
- 이후 `/uploadStatus` GET 요청 시 모델에 `message`가 담겨 자동으로 노출됨
- 플래시 속성은 URL 쿼리 파라미터로 노출되지 않고 세션에 임시 저장됨

<br>

## 주요 메서드 및 개념

- `RedirectAttributes.addFlashAttribute(String name, Object value)`: 플래시 속성을 추가
- `RequestContextUrils.getInputFlashMap(request)`등으로 직접 `FlashMap`을 조회 가능하지만, 대부분 컨트롤러 메서드에서는 `RedirectAttributes`를 사용하면 충분함
- 플래시 속성 저장과 검색은 내부적으로 `FlashMap` ➡️ 리다이렉트 ➡️ 다음 요청에서 `FlashMap` 순으로 흐름

<br>

## 유의사항 및 베스트 프랙티스

- 플래시 속성은 리다이렉트된 이후 요청에만 유효하며, 사용 후 삭제됨
- 플래시 속성은 URL 쿼리 매개변수로 노출되지 않기 때문에 보안상 민감한 데이터를 전달할 때 유용함
- 모델에 그냥 `model.addAttribute()` 방식으로 설정하면 리다이렉트 시 URL에 노출되거나 예기치 않게 사라질 수 있으므로, 리다이렉트 전엔 `RedirectAttributes` 사용이 권장
- 동시성 이슈 주의: 리다이렉트 이후 다음 요청이 반드시 의도된 요청일 수 없으며, AJAX나 리소스 요청이 먼저 들어오면 플래시 속성이 소모돼버릴 수 있음
- 사용하지 않을 경우에도 세션이 생성되지 않도록 설계되어 있어, 플래시 속성을 사용해도 성능 저하나 세션 부하 걱정은 기본적으로 적음