---
layout: post
title: ResponseEntity
date: 2025-11-18 09:00:00 +09:00
categories: [Spring, Reactive Stack, WebFlux, Annotated Controllers, Handler Methods]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- `ResponseEntity<T>`는 HTTP 응답의 상태코드, 헤더, 본문을 모두 제어할 수 있게 해주는 Spring 타입임
- 즉, 단순히 반환 객체만 보내는 `@ResponseBody` 방식보다 더 세밀한 제어가 가능하며, REST API 응답 설계 시 유용함
- Spring MVC뿐 아니라, 리액티브 스택에서도 `ResponseEntity` 반환을 지원하며, 이 경우 비동기 타입과 함께 사용할 수 있다는 특징이 있음

<hr>

## 사용법 및 예제 코드

#### Java 예제

```java
@RestController
@RequestMapping("/api/accounts")
public class AccountController {

    @GetMapping("/{id}")
    public ResponseEntity<Account> getAccount(@PathVariable Long id) {
        Optional<Account> opt = accountService.findById(id);
        if (opt.isEmpty()) {
            return ResponseEntity.notFound().build();           // 상태 404
        }
        Account account = opt.get();
        return ResponseEntity
                 .ok()                                             // 상태 200
                 .header("X-Account-Version", account.getVersion().toString())   // 헤더 추가
                 .body(account);                                   // 본문 설정
    }

    @PostMapping
    public ResponseEntity<Void> createAccount(@RequestBody Account account) {
        Long newId = accountService.create(account);
        URI location = URI.create("/api/accounts/" + newId);
        return ResponseEntity
                 .created(location)                               // 상태 201 + Location 헤더
                 .build();
    }
}
```

- `ResponseEntity.ok().body(..)`: HTTP 200 상태
- `ResponseEntity.created(location).build()`: HTTP 201 + `Location` 헤더
- `notFound().build()`: HTTP 404 상태
- 헤더 값도 `.header(...)` 또는 `.headers(...)` 메서드로 추가 가능

<hr>

## 특징 및 활용 팁

- **상태 코드 지정 가능**: `ResponseEntity.status(HttpStatus.X)` 또는 위의 빌더 메서드(`ok()`, `created()`, `badRequest()`, `notFound()` 등)를 이용해 상태 코드를 지정
- **헤더 제어 기능**: 응답 헤더를 직접 설정할 수 있어, 캐싱 정택, ETag, Location, Content-Type 등 다양한 HTTP 응답 제어가 가ㅏ능
- 본문 제어 가능: 타입 파라미터 `T`로 본문 타입을 지정하고, 메시지 컨버터 (`HttpMessageConverter`)가 자동으로 직렬화/역직렬화를 수행
- 파일/리소스 반환: `ResponseEntity<Resource>` 형태로 파일이나 리소스를 반환할 때도 유용함
  - 예컨대 `InputStreamResource`를 바디로 설정하고 적절한 헤더(`Content-Disposition`, `Content-Length`)를 추가하는 방식으로 파일 다운로드 구현 가능
- 리액티브 타입과 결합: WebFlux 환경에서는 `Mono<ResponseEntity<T>>` 또는 `Flux<ResponseEntity<T>>` 형태로 비동기 응답을 처리할 수 있음