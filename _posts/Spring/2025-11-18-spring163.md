---
layout: post
title: Jackson JSON
date: 2025-11-18 09:00:00 +09:00
categories: [Spring, Reactive Stack, WebFlux, Annotated Controllers, Handler Methods]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 목적

- 객체 전체의 필드를 항상 직렬화하는 것이 아니라, 상황에 따라 필드의 일부만 직렬화하ㅏㅎ 수 있도록 함
  - 즉, 같은 객체라도 어떤 API 호출에서는 특정 필드만 보여주고 다른 호출에서는 더 많은 필드를 보여주는 형태로 제어할 수 있음
- 이는 API 응답에서 노출하고 싶지 않은 필드를 숨기거나, 요약/상세 모드로 나누어 응답을 제공할 때 유용

<hr>

## 사용방법

#### @JsonView 어노테이션 이용

- 컨트롤러 메서드에 `@JsonView(ViewClass.class)` 을 붙이면, 반환 객체에 대해 Jsackson이 해당 View를 활성화하여 직렬화 시 필드를 필터링 함

```java
@RestController
public class UserController {
    @GetMapping("/user")
    @JsonView(User.WithoutPasswordView.class)
    public User getUser() {
        return new User("eric", "7!jd#h23");
    }
}

public class User {
    public interface WithoutPasswordView {};
    public interface WithPasswordView extends WithoutPasswordView {};

    private String username;
    private String password;

    @JsonView(WithoutPasswordView.class)
    public String getUsername() { return username; }

    @JsonView(WithPasswordView.class)
    public String getPassword() { return password; }
}
```

- 위 예시에서 `/user` 호출 시 `WithoutPasswordView가 적용되어 `username`은 나온지만 `password`는 나오지 않음
- `@JsonView` 어노테이션에는 배열 형식도 지정할 수 있으나, 컨트롤러 메서드에는 하나만 지정가능함
  - 여러 개를 지정해야 한다면 합성 인터페이스를 만들어 사용해야 함

<br>

#### MappingJacksonValue를 이용한 프로그래매틱 설정

- 어노테이션 대신 코드 내부에서 직렬화 뷰를 설정하고 싶을 때 사용
  

```java
@GetMapping("/user")
public MappingJacksonValue getUser() {
    User user = new User("eric", "7!jd#h23");
    MappingJacksonValue value = new MappingJacksonValue(user);
    value.setSerializationView(User.WithoutPasswordView.class);
    return value;
}
```

- 이 경우, 반환 객체가 `MappingJacksonValue`이므로 message converter가 이를 인식해 해당 View를 적용

<br>

#### 뷰 리졸버 방식과의 연계

- `@Controller`가 뷰 리졸버를 사용하는 경우 모델에 `JsonView.class.getName()` 키로 뷰 클래스를 추가하는 방식으로도 지원됨

```java
@Controller
public class UserController {
    @GetMapping("/user")
    public String getUser(Model model) {
        model.addAttribute("user", new User("eric", "7!jd#h23"));
        model.addAttribute(JsonView.class.getName(), User.WithoutPasswordView.class);
        return "userView"; // 뷰 이름
    }
}
```

<hr>

## 주요 유의사항 및 추가 정보