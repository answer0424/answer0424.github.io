---
layout: post
title: Asynchronous Requests
date: 2025-11-20 09:00:00 +09:00
categories: [Spring, Reactive Stack, WebFlux]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---


## 개요

- Spring MVC는 Servlet 3.0 이상이 제공하는 비동기 요청 처리 기능을 적극적으로 통합하고 있음
- 이를 통해 컨트롤러 메서드가 요청 처리 스레드를 바로 차지하지 않고, 나중에 결과를 설정하거나 스트리밍하는 방식으로 응답을 제공할 수 있음
- 주요 반환 타입으로는 DeferredResult, Callable, WebAsyncTask 등이 있으며, 스트리밍 응답을 위해 ResponseBodyEmitter, SseEmitter, StreamingResponseBody 등이 지원됨
- 또한, 리엑티브 타입을 컨트롤러 반환값으로 사용하는 것이 가능하며, 내부에서는 DeferredResult 또는 스트리밍 방식으로 변환되어 처리됨

<hr>

## 주요 처리 유형 및 사용 방식

#### `Callable`

- 컨트롤러 메서드가 즉시 응답값을 반환하지 않고, `Callable<V>` 형태로 반환함으로써 별도 스레드에서 처리하게 할 수 있음

```java
@GetMapping("/callable")
public Callable<String> handle() {
    return () -> {
        // 장시간 처리
        Thread.sleep(10000);
        return "asynchronous request completed";
    };
}
``` :contentReference[oaicite:13]{index=13}  
```

- 처리 흐름: 요청 ➡️ DispatcherServlet에서 비동기모드 시작 ➡️ `Callable` 실행 ➡️ 결과 리턴 ➡️ 다시 Servlet 컨테이너로 디스패치 ➡️ 응답 완료

<br>

#### `DeferredResult`

- 컨트롤러 메서드가 `DeferredResult<V>`를 반환하고 이후 다른 쓰레드나 이벤트에서 `deferredResult.setResult(V result)` 혹은 `setErrorResult(...)`를 호출하여 응답을 마무리하는 방식임

```java
@GetMapping("/quotes")
@ResponseBody
public DeferredResult<String> quotes() {
    DeferredResult<String> deferredResult = new DeferredResult<>();
    // 어떤 외부 이벤트 또는 스케줄러에서 결과 설정...
    return deferredResult;
}
```

<br>

#### `WebAsyncTask`

- `Callable` 방식 위에 타임아웃 설정, 별도 `AsyncTaskExecutor` 지정과 같은 추가 기능을 제공하는 래퍼 타입

```java
@GetMapping("/callable")
WebAsyncTask<String> handle() {
    return new WebAsyncTask<>(20000L, () -> {
        Thread.sleep(10000);
        return "asynchronous request completed";
    });
}
```

<br>

#### HTTP 