---
layout: post
title: WebSocket
date: 2025-11-25 09:00:00 +09:00
categories: [Spring, Reactive Stack]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 개요

- WebFlux는 리액티브 스트림 기반 웹 스택으로서, WebSocket을 통한 양방향 및 풀-듀플렉스 통신을 지원함
- 서버 측 설정, 클라이언트 측 사용, CORS나 업그레이드 전략 등 여러 세부사항을 다룸

<hr>

## 서버 설정(핸드셰이크 포함)

#### 핸드셰이크 처리

- `WebSocketHandlerAdapter` 빈이 요청 업그레이드를 처리함 이때 `WebSocketService`가 실제 전략을 제공함
- 기본적으로 `HandshakeWebSocketService` 구현체가 사용되며, 리액티브 서버 엔진에 맞는 `RequestUpgradeStrategy`를 전달할 수 있음

<br>

#### 설정 예시


```java
@Configuration
public class WebSocketConfig {
    @Bean
    public WebSocketHandlerAdapter handlerAdapter() {
        return new WebSocketHandlerAdapter(webSocketService());
    }

    @Bean
    public WebSocketService webSocketService() {
        TomcatRequestUpgradeStrategy upgradeStrategy = new TomcatRequestUpgradeStrategy();
        strategy.setMaxSessionIdleTimeout(0L); // 무제한 타임아웃
        return new HandShakeWebSocketService(strategy);
    }
```

- 위 처럼 업그레이드 전략, 세션 타임아웃 등의 커스터마이즈 가능 