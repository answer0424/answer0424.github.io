---
layout: post
title: JDBC Testing Support
date: 2025-11-27 09:00:00 +09:00
categories: [Spring, Testing]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---


## 개요

- `spring-jdbc` 모듈은 임베디드 데이터베이스 설정 및 실행을 지원
  - 이 기능은 데이터베이스와 상호작용하는 로직을 포함한 통합 테스트를 할 때 유용
- 즉, 외부 DB 서버 없이도 테스트용 메모리 DB를 띄워서 JDBC 기반 데이터 액세스 코드 전체 흐름을 검증할 수 있음

<hr>

## 제공 요소

- Embedded Database 생성 및 초기화 지원
  - 일반적으로 테스트 실행 시 자동으로 인메모리 DB가 준비됨
- Spring TestContext Framework와 통합
  - `ApplicationContext` + `DataSource` + 트랜잭션 관리 포함 상태에서 테스트 가능
- DAO / Repository 등 JDBC 기반 데이터 액세스 계층에 대한 테스트 편의 기능 제공

<hr>

## 일반 사용 방식 & 예시 

- 예: `@JdbcTest` 어노테이션 - 이 어노테이션이 붙은 클래스 테스트는 JDBC 관련 컴포넌트만 로딩하고, 인메모리 DB + 자동 롤백 설정이 적용됨
- DAO/Repository 구현체 단위 테스트: 실제 DB가 아닌 embedded DB + `JdbcTemplate` 기반으로 SQL 실행, CRUD 동작, 트랜잭션 동작 등을 검증 가능

```java
@JdbcTest
public class MyDaoTest {

    @Autowired
    private JdbcTemplate jdbcTemplate;

    // DAO 인스턴스를 jdbcTemplate 기반으로 생성
    private MyDao myDao;

    @BeforeEach
    void setUp() {
        myDao = new MyDao(jdbcTemplate);
    }

    @Test
    void testInsertAndFind() {
        MyEntity e = new MyEntity(...);
        myDao.insert(e);

        MyEntity found = myDao.findById(e.getId());
        assertEquals(e.getSomeField(), found.getSomeField());
    }
}
```

- 위와 같이 테스트하면, 실제 외부 DB 없이도 DAO 레이어가 잘 동작하는지 검증할 수 있음

<hr>

## 장점 & 유의할 점

#### 장점

- 외부 DB 설치나 운영 환경 없이 빠르고 독립적인 테스트 환경 제공
- 스키마 초기화를 포함한 테스트 가능 ➡️ 실제 실 DB 환경과 유사한 통합 테스트 가능
- `spring-jdbc` + Spring TestContext 조합 덕분에 설정이 간단 