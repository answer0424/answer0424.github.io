---
layout: post
title: Key Abstractions
date: 2025-11-27 09:00:00 +09:00
categories: [Spring, Testing]
tags: [spring]
image:
    path: /assets/img/spring/Spring.png
---

## 핵심 추상들

| 추상/클래스 | 역할/책임 |
|-|-|
| TestContext | 현재 테스트 실행에 대한 컨텍스트 정보를 캡슐화 - 즉, 테스트 실행환경을 가진 객체. 필요 시 `ApplicationContext`를 로드하거나 캐시에서 가져오는 역할 포함 |
| TestContextManager | `TestContext`를 관리하고, 테스트 실행의 각 단계에 맞춰 등록된 리스너들(`TestExecutionListener`)에게 이벤트를 전달하는 중추 엔진 |
| TestExecutionListener | 테스트 실행의 특정 단계에 개입할 수 있는 리스너 인터페이스. 의존성 주입, 트랜잭션 관리, 컨텍스트 초기화/종료, 커스텀 후처리 등 다양한 기능을 구현 가능 |
| SmartContextLoader | 테스트 클래스의 설정을 보고 `ApplicationContext`를 생성해주는 전략. 즉, 어떤 빈 설정을 불러올지 판단하고 컨텍스트를 로드하는 책임자 |

<hr>

## 동작 흐름

1. 테스트 클래스 단위로 `TestContextManager` 생성 ➡️ 이 안에 `TestContext` 인스턴스 포함
2. 테스트 실행 전후, lifecycle 지점마다 `TestContextManager`가 `TestExecutionListener`들에 이벤트를 보내서 설정, DI, 트랜잭션 설정, 리소스 초기화/정리 등을 수행
3. 만약 테스트에서 `ApplicationContext`가 필요하면 - `SmartContextLoader`가 호출되어 `ApplicationContext`를 로드 혹은 캐시된 컨텍스트를 재사용 

